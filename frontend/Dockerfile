FROM node:10-alpine

WORKDIR /app
COPY package.json /app/
COPY package-lock.json /app/
RUN npm install

ARG API_URL
ARG APP_URL
ARG APP_NAME
ARG APP_LOCALE
ARG SENTRY_LARAVEL_DSN

ENV HOST 0.0.0.0
ENV PORT 3000

ENV NUXT_ENV_VERSION $NUXT_ENV_VERSION

ENV API_URL $API_URL
ENV APP_URL $APP_URL
ENV APP_NAME $APP_NAME
ENV APP_LOCALE $APP_LOCALE
ENV SENTRY_LARAVEL_DSN $SENTRY_LARAVEL_DSN

COPY . /app/
RUN npm run build

EXPOSE 3000

CMD [ "npm", "run", "start" ]